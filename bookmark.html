<!DOCTYPE html>
<html>
<head>
  <title>Bookmark</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js" type="text/javascript"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js" type="text/javascript"></script>

  <style>
  .actions {
    /*display: none;*/
    width: 40%;
    float: right;
  }
  </style>
</head>

<body>
  <script>

      (function($){
        var Bookmark = Backbone.Model.extend({
          defaults: {
            name: 'Untittled',
            url: 'google.com'
          }
        });

        var Folder = Backbone.Collection.extend({
          model: Bookmark
        });

        var BookmarkView = Backbone.View.extend({
            tagName: 'li',
            initialize: function(){
              _.bindAll(this, 'render');
            },
            render: function(){
              var url = this.model.get('url');
              $(this.el).html('<span><label>'+this.model.get('name')+'</label>: <a href="'+url+'">'+url+'</a><span class="actions"><a class="edit">EDIT</a><a class="move">MOVE</a><a class="remove">DELETE</a></span></span>');
              return this;
            }
       });

       var FolderView = Backbone.View.extend({
             el: $('body'),
             events: {
               'click button#add': 'addBookmark'
             },
             initialize: function(){
               _.bindAll(this, 'render', 'addBookmark', 'appendBookmark');

               this.collection = new Folder();
               this.collection.bind('add', this.appendBookmark);

               this.render();
             },
             render: function(){
               var self = this;
               $(this.el).append("<button id='add'>+New Bookmark</button>");
               $(this.el).append("<ul></ul>");
               _(this.collection.models).each(function(item){
                 self.appendBookmark(item);
               }, this);
             },
             addBookmark: function(){
               var item = new Bookmark();
               item.set({
                 url: item.get('url')
               });
               this.collection.add(item);
             },
             appendBookmark: function(item){
               var itemView = new BookmarkView({
                 model: item
               });
               $('ul', this.el).append(itemView.render().el);
             }
       });

       var listView = new FolderView();
      })(jQuery);
      </script>
</body>

</html>
